<!doctype html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ARP Security Audit | Agent Relay Protocol</title>
    
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90' text-anchor='middle' x='50' fill='%2300E5FF'%3E◈%3C/text%3E%3C/svg%3E" />
    
    <!-- Theme setup script to prevent FOUC -->
    <script data-cfasync="false">
        if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
    </script>

    <!-- Fonts: Inter for UI, JetBrains Mono for Code -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script data-cfasync="false" src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script data-cfasync="false" src="https://unpkg.com/lucide@latest"></script>

    <!-- Tailwind Config with Dynamic Theme Variables -->
    <script data-cfasync="false">
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        background: 'var(--bg-main)',
                        surface: 'var(--bg-surface)',
                        panel: 'var(--bg-panel)',
                        border: 'var(--border-color)',
                        textMain: 'var(--text-main)',
                        textMuted: 'var(--text-muted)',
                        textDim: 'var(--text-dim)',
                        accent: {
                            cyan: '#00E5FF',
                            cyanDark: '#0097A7',
                            purple: '#8A2BE2',
                            orange: '#FF5500',
                            green: '#00C853'
                        }
                    },
                    letterSpacing: {
                        tightest: '-0.04em',
                    },
                    boxShadow: {
                        'glow': '0 0 40px var(--shadow-glow)',
                        'glow-sm': '0 0 20px var(--shadow-glow)',
                    }
                }
            }
        }
    </script>

    <style>
        /* Light/Dark Mode Variables */
        :root {
            --bg-main: #FAFAFA;
            --bg-surface: #FFFFFF;
            --bg-panel: #F4F4F5;
            --border-color: #E4E4E7;
            --text-main: #09090B;
            --text-muted: #52525B;
            --text-dim: #A1A1AA;
            --shadow-glow: rgba(0, 229, 255, 0.15);
            --hero-gradient-start: #000000;
            --hero-gradient-end: #666666;
            --radial-overlay: radial-gradient(circle at top center, #FFFFFF 0%, #FAFAFA 70%);
        }

        .dark {
            --bg-main: #000000;
            --bg-surface: #0A0A0A;
            --bg-panel: #111111;
            --border-color: #222222;
            --text-main: #FFFFFF;
            --text-muted: #A1A1AA;
            --text-dim: #71717A;
            --shadow-glow: rgba(0, 229, 255, 0.12);
            --hero-gradient-start: #FFFFFF;
            --hero-gradient-end: #888888;
            --radial-overlay: radial-gradient(circle at top center, #111111 0%, #000000 70%);
        }

        body {
            background-color: var(--bg-main);
            color: var(--text-main);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            transition: background-color 0.3s, color 0.3s;
        }

        /* Minimalist Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-main); }
        ::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-dim); }

        .radial-mask {
            background: var(--radial-overlay);
        }

        /* Custom Markdown Styling Elements */
        .prose-custom p {
            margin-bottom: 1.5rem;
            line-height: 1.75;
            color: var(--text-muted);
        }
        .prose-custom h2 {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-main);
            margin-top: 3rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-color);
            letter-spacing: -0.02em;
        }
        @media (min-width: 640px) {
            .prose-custom h2 { font-size: 1.875rem; }
        }
        .prose-custom h3 {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-main);
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            letter-spacing: -0.01em;
        }
        .prose-custom h4 {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-main);
            margin-top: 2rem;
            margin-bottom: 0.75rem;
        }
        .prose-custom ul {
            list-style-type: none;
            margin-bottom: 1.5rem;
            padding-left: 0.5rem;
        }
        .prose-custom ul > li {
            position: relative;
            padding-left: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--text-muted);
            line-height: 1.6;
        }
        .prose-custom ul > li::before {
            content: '◈';
            position: absolute;
            left: 0;
            top: 0.1rem;
            color: var(--text-dim);
            font-size: 0.75rem;
        }
        .prose-custom strong {
            color: var(--text-main);
            font-weight: 600;
        }
        .prose-custom a {
            color: var(--tw-colors-accent-cyan);
            text-decoration: underline;
            text-decoration-color: rgba(0, 229, 255, 0.3);
            text-underline-offset: 4px;
            transition: all 0.2s;
        }
        .prose-custom a:hover {
            text-decoration-color: var(--tw-colors-accent-cyan);
        }

        /* Syntax block formatting */
        .code-block {
            background-color: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            padding: 1.25rem;
            margin: 2rem 0;
            overflow-x: auto;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .dark .code-block {
            background-color: #050505;
            box-shadow: inset 0 0 0 1px rgba(255,255,255,0.02);
        }

        /* Inline code */
        code.inline-code {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85em;
            background-color: var(--bg-panel);
            color: var(--text-main);
            padding: 0.2em 0.4em;
            border-radius: 0.375rem;
            border: 1px solid var(--border-color);
        }

        /* Table styling */
        .table-wrapper {
            width: 100%;
            overflow-x: auto;
            margin: 2rem 0;
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            background-color: var(--bg-surface);
        }
        .prose-custom table {
            width: 100%;
            border-collapse: collapse;
            text-align: left;
            font-size: 0.875rem;
            white-space: nowrap;
        }
        .prose-custom th {
            background-color: var(--bg-panel);
            padding: 1rem;
            font-weight: 600;
            color: var(--text-main);
            border-bottom: 1px solid var(--border-color);
        }
        .prose-custom td {
            padding: 1rem;
            color: var(--text-muted);
            border-bottom: 1px solid var(--border-color);
        }
        .prose-custom tr:last-child td {
            border-bottom: none;
        }

        /* TOC Active State */
        .toc-link.active {
            color: var(--tw-colors-accent-cyan);
            font-weight: 700;
        }
        .toc-link.active::before {
            content: '';
            position: absolute;
            left: -1rem;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 4px;
            background-color: var(--tw-colors-accent-cyan);
            border-radius: 50%;
            box-shadow: 0 0 8px var(--tw-colors-accent-cyan);
        }
        .toc-item {
            position: relative;
        }
    </style>
</head>
<body class="font-sans overflow-x-hidden selection:bg-textMain selection:text-background relative">

    <!-- Background Gradient -->
    <div class="fixed inset-0 radial-mask z-[-1] pointer-events-none"></div>

    <!-- Clean Inline Logo Header -->
    <div class="absolute top-6 left-6 sm:top-8 sm:left-10 z-50">
        <a href="index.html" class="font-sans font-bold text-sm sm:text-base tracking-widest text-textMain flex items-center gap-2 select-none hover:opacity-80 transition-opacity group">
            <span class="text-accent-cyan text-xl -mt-1 drop-shadow-[0_0_8px_rgba(0,229,255,0.5)] group-hover:-translate-x-1 transition-transform">◈</span> 
            <span class="tracking-widest">ARP</span> 
        </a>
    </div>

    <!-- Theme Toggle -->
    <div class="absolute top-6 right-6 sm:top-8 sm:right-10 z-50 flex items-center gap-4">
        <a href="index.html" class="hidden sm:flex text-[11px] font-mono uppercase tracking-widest text-textDim hover:text-textMain transition-colors items-center gap-1.5 font-semibold">
            <i data-lucide="arrow-left" class="w-3.5 h-3.5"></i> Back to Home
        </a>
        <button id="themeToggle" class="w-10 h-10 flex items-center justify-center rounded-full bg-surface border border-border text-textMuted hover:text-textMain hover:border-textDim transition-all shadow-sm focus:outline-none focus:ring-2 focus:ring-border focus:ring-offset-2 focus:ring-offset-background">
            <i data-lucide="moon" class="w-4 h-4 hidden dark:block"></i>
            <i data-lucide="sun" class="w-4 h-4 block dark:hidden"></i>
        </button>
    </div>

    <!-- Main Content Layout -->
    <main class="max-w-[90rem] mx-auto px-4 sm:px-6 lg:px-8 pt-32 pb-24 flex flex-col lg:flex-row gap-12 lg:gap-20 items-start">
        
        <!-- Desktop Sidebar (TOC) -->
        <aside class="hidden lg:block w-64 shrink-0 sticky top-32 max-h-[calc(100vh-10rem)] overflow-y-auto custom-scrollbar pr-4">
            <div class="font-mono text-textMain text-[10px] uppercase tracking-widest mb-6 border-b border-border pb-4 font-bold flex items-center gap-2">
                <i data-lucide="list" class="w-3.5 h-3.5"></i> Contents
            </div>
            <nav id="toc" class="flex flex-col gap-3 font-mono text-[11px] uppercase tracking-widest text-textDim">
                <div class="toc-item"><a href="#metadata" class="hover:text-textMain transition-colors toc-link">Report Metadata</a></div>
                <div class="toc-item mt-2"><a href="#summary" class="hover:text-textMain transition-colors toc-link">Security Posture Summary</a></div>
                <div class="toc-item mt-2"><a href="#executive" class="hover:text-textMain transition-colors toc-link">Executive Summary</a></div>
                
                <div class="toc-item mt-3"><a href="#s1" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">1. Methodology</a></div>
                <div class="toc-item mt-2"><a href="#s2" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">2. Architecture Review</a></div>
                <div class="toc-item mt-2"><a href="#s3" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">3. Cryptographic Analysis</a></div>
                <div class="toc-item mt-2"><a href="#s4" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">4. Network Security</a></div>
                <div class="toc-item mt-2"><a href="#s5" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">5. Authentication</a></div>
                <div class="toc-item mt-2"><a href="#s6" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">6. Input Validation</a></div>
                <div class="toc-item mt-2"><a href="#s7" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">7. Rate Limiting & DoS</a></div>
                <div class="toc-item mt-2"><a href="#s8" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">8. Config & Secrets</a></div>
                <div class="toc-item mt-2"><a href="#s9" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">9. Supply Chain Security</a></div>
                <div class="toc-item mt-2"><a href="#s10" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">10. CI/CD & Deployment</a></div>
                <div class="toc-item mt-2"><a href="#s11" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">11. Code Quality</a></div>
                <div class="toc-item mt-2"><a href="#s12" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">12. Logging & Disclosure</a></div>
                <div class="toc-item mt-2"><a href="#s13" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">13. Whitepaper Spec</a></div>
                <div class="toc-item mt-2"><a href="#s14" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">14. Findings Summary</a></div>
                <div class="toc-item mt-2"><a href="#s15" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">15. Strengths</a></div>
                <div class="toc-item mt-2"><a href="#s16" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">16. Recommendations</a></div>
                
                <div class="toc-item mt-3"><a href="#app-a" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">Appendix A</a></div>
                <div class="toc-item mt-2"><a href="#app-b" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">Appendix B</a></div>
                <div class="toc-item mt-2"><a href="#app-c" class="hover:text-textMain transition-colors toc-link font-semibold text-textMain">Appendix C</a></div>
            </nav>
        </aside>

        <!-- Main Content Area -->
        <article class="flex-1 max-w-3xl lg:max-w-4xl w-full mx-auto prose-custom">
            
            <!-- Mobile TOC (Details) -->
            <details class="lg:hidden mb-12 bg-surface border border-border rounded-xl group shadow-sm">
                <summary class="p-4 font-mono text-[11px] uppercase tracking-widest font-semibold text-textMain cursor-pointer flex justify-between items-center focus:outline-none">
                    <span class="flex items-center gap-2"><i data-lucide="list" class="w-4 h-4 text-accent-cyan"></i> Table of Contents</span>
                    <i data-lucide="chevron-down" class="w-4 h-4 text-textDim transition-transform group-open:rotate-180"></i>
                </summary>
                <div class="p-4 border-t border-border font-mono text-[11px] tracking-widest text-textDim uppercase flex flex-col gap-3">
                    <a href="#metadata" class="hover:text-textMain">Report Metadata</a>
                    <a href="#summary" class="hover:text-textMain">Security Posture Summary</a>
                    <a href="#executive" class="hover:text-textMain">Executive Summary</a>
                    <a href="#s1" class="hover:text-textMain font-semibold mt-2">1. Methodology</a>
                    <a href="#s2" class="hover:text-textMain font-semibold">2. Architecture Review</a>
                    <a href="#s3" class="hover:text-textMain font-semibold">3. Cryptographic Analysis</a>
                    <a href="#s4" class="hover:text-textMain font-semibold">4. Network Security</a>
                    <a href="#s5" class="hover:text-textMain font-semibold">5. Authentication</a>
                    <a href="#s6" class="hover:text-textMain font-semibold">6. Input Validation</a>
                    <a href="#s7" class="hover:text-textMain font-semibold">7. Rate Limiting</a>
                    <a href="#s8" class="hover:text-textMain font-semibold">8. Config & Secrets</a>
                    <a href="#s9" class="hover:text-textMain font-semibold">9. Supply Chain</a>
                    <a href="#s10" class="hover:text-textMain font-semibold">10. CI/CD & Deployment</a>
                    <a href="#s11" class="hover:text-textMain font-semibold">11. Code Quality</a>
                    <a href="#s12" class="hover:text-textMain font-semibold">12. Logging</a>
                    <a href="#s13" class="hover:text-textMain font-semibold">13. Whitepaper Spec</a>
                    <a href="#s14" class="hover:text-textMain font-semibold">14. Findings Summary</a>
                    <a href="#s15" class="hover:text-textMain font-semibold">15. Strengths</a>
                    <a href="#s16" class="hover:text-textMain font-semibold">16. Recommendations</a>
                    <a href="#app-a" class="hover:text-textMain font-semibold mt-2">Appendices</a>
                </div>
            </details>

            <!-- Header -->
            <header class="mb-16">
                <h1 class="text-4xl sm:text-5xl md:text-6xl font-black tracking-tight mb-6 text-textMain leading-[1.1] text-balance">
                    Security Audit Report <span class="text-textDim font-normal">(ARP)</span>
                </h1>
                <div class="inline-flex items-center gap-3 px-4 py-2 rounded-full border border-accent-cyan/30 bg-accent-cyan/5 text-accent-cyan font-mono text-[10px] sm:text-[11px] uppercase tracking-widest font-semibold shadow-[0_0_15px_rgba(0,229,255,0.05)]">
                    <i data-lucide="shield-check" class="w-3.5 h-3.5"></i>
                    Independent AI-Assisted Assessment | Feb 24, 2026
                </div>
            </header>

            <section id="metadata" class="scroll-mt-24">
                <h2 class="text-2xl mt-0 border-none pb-0">Report Metadata</h2>
                <div class="table-wrapper mt-6">
                    <table>
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Detail</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border">
                            <tr><td><strong>Project</strong></td><td>ARP (Agent Relay Protocol)</td></tr>
                            <tr><td><strong>Repository</strong></td><td><code class="inline-code">offgrid-ing/arp</code></td></tr>
                            <tr><td><strong>Version</strong></td><td>v0.2.4</td></tr>
                            <tr><td><strong>Commit</strong></td><td><code class="inline-code">32b76c5</code></td></tr>
                            <tr><td><strong>Protocol Version</strong></td><td><code class="inline-code">arp.v2</code></td></tr>
                            <tr><td><strong>Audit Date</strong></td><td>February 24, 2026</td></tr>
                            <tr><td><strong>Auditor</strong></td><td>Independent AI-Assisted Security Review (Claude, Anthropic)</td></tr>
                            <tr><td><strong>Methodology</strong></td><td>Full manual source code review + automated static analysis</td></tr>
                            <tr><td><strong>Scope</strong></td><td>100% of source code across 3 crates (~7,900 LoC), whitepaper, CI/CD, deployment infrastructure</td></tr>
                            <tr><td><strong>Overall Risk Rating</strong></td><td><strong class="text-accent-green">LOW</strong></td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="summary" class="scroll-mt-24">
                <h2>Security Posture Summary</h2>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Area</th>
                                <th>Status</th>
                                <th>Key Controls</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border">
                            <tr><td><strong>Cryptography</strong></td><td>✅ Pass</td><td>HPKE RFC 9180 (Auth mode), Ed25519, ChaCha20Poly1305, zeroized key material</td></tr>
                            <tr><td><strong>Authentication</strong></td><td>✅ Pass</td><td>Ed25519 challenge-response, SHA-256 PoW, relay pubkey pinning</td></tr>
                            <tr><td><strong>Network Security</strong></td><td>✅ Pass</td><td>TLS via reverse proxy enforcement, pre-auth semaphore, per-IP connection limits</td></tr>
                            <tr><td><strong>Input Validation</strong></td><td>✅ Pass</td><td>Defensive binary parsing, bounded frames, property-based testing (proptest)</td></tr>
                            <tr><td><strong>Rate Limiting & DoS</strong></td><td>✅ Pass</td><td>Three-layer defense (edge &rarr; admission &rarr; runtime), sliding window, bounded channels</td></tr>
                            <tr><td><strong>Configuration & Secrets</strong></td><td>✅ Pass</td><td>0600 key file permissions, directory permission checks, platform-aware warnings</td></tr>
                            <tr><td><strong>Supply Chain</strong></td><td>✅ Pass</td><td>OpenSSL explicitly banned, <code class="inline-code">cargo-deny</code> enforced in CI, Dependabot weekly</td></tr>
                            <tr><td><strong>CI/CD & Deployment</strong></td><td>✅ Pass</td><td><code class="inline-code">clippy -D warnings</code>, full test suite, mandatory binary checksums, auto-rollback</td></tr>
                            <tr><td><strong>Code Quality</strong></td><td>✅ Pass</td><td><code class="inline-code">#![forbid(unsafe_code)]</code> all crates, zero reachable panics from network input</td></tr>
                            <tr><td><strong>Information Disclosure</strong></td><td>✅ Pass</td><td>No secrets in logs, explicit redaction, minimal wire error messages</td></tr>
                        </tbody>
                    </table>
                </div>

                <div class="grid grid-cols-2 sm:grid-cols-5 gap-4 mt-6 mb-8">
                    <div class="bg-surface border border-border rounded-xl p-4 text-center shadow-sm">
                        <div class="text-textDim text-xs uppercase tracking-wider font-semibold mb-1">Critical</div>
                        <div class="text-2xl font-bold text-textMain">0</div>
                    </div>
                    <div class="bg-surface border border-border rounded-xl p-4 text-center shadow-sm">
                        <div class="text-textDim text-xs uppercase tracking-wider font-semibold mb-1">High</div>
                        <div class="text-2xl font-bold text-textMain">0</div>
                    </div>
                    <div class="bg-surface border border-border rounded-xl p-4 text-center shadow-sm">
                        <div class="text-textDim text-xs uppercase tracking-wider font-semibold mb-1">Medium</div>
                        <div class="text-2xl font-bold text-textMain">0</div>
                    </div>
                    <div class="bg-surface border border-border rounded-xl p-4 text-center shadow-sm">
                        <div class="text-textDim text-xs uppercase tracking-wider font-semibold mb-1">Low</div>
                        <div class="text-2xl font-bold text-textMain">0</div>
                    </div>
                    <div class="bg-surface border border-accent-cyan/30 rounded-xl p-4 text-center shadow-[0_0_15px_rgba(0,229,255,0.05)] col-span-2 sm:col-span-1">
                        <div class="text-accent-cyan text-xs uppercase tracking-wider font-semibold mb-1">Informational</div>
                        <div class="text-2xl font-bold text-textMain">2</div>
                    </div>
                </div>

                <div class="border-l-2 border-accent-cyan pl-5 py-3 mb-8 bg-gradient-to-r from-accent-cyan/5 to-transparent rounded-r-xl">
                    <p class="text-[15px] sm:text-base text-textMain leading-relaxed !mb-0">
                        <strong>No exploitable vulnerabilities were identified.</strong> All informational observations are architectural notes documenting intentional design decisions with safe failure modes.
                    </p>
                </div>
            </section>

            <section id="executive" class="scroll-mt-24">
                <h2>Executive Summary</h2>
                <p>This report documents the comprehensive security audit of the Agent Relay Protocol (ARP), a stateless WebSocket relay for autonomous AI agent communication. The assessment covers the protocol specification (<code class="inline-code">whitepaper.md</code>), all three Rust crates (<code class="inline-code">arp-common</code>, <code class="inline-code">arps</code>, <code class="inline-code">arpc</code>), CI/CD pipelines, dependency chain, and deployment infrastructure.</p>
                
                <p>The audit concludes with a <strong>LOW overall risk rating</strong>, reflecting an exceptionally strong security posture. No exploitable vulnerabilities were discovered. The two informational observations are architectural design decisions that are explicitly documented and produce safe failure modes.</p>

                <p>The ARP project exemplifies security-first engineering. The stateless relay architecture eliminates entire attack categories by design — no database to compromise, no sessions to hijack, no persistent storage to exfiltrate. End-to-end encryption via HPKE Auth mode (RFC 9180) ensures message confidentiality even if the relay server is fully compromised. The codebase enforces <code class="inline-code">#![forbid(unsafe_code)]</code> across all crates, providing compiler-guaranteed memory safety. Cryptographic key material is protected with automatic memory zeroing via the <code class="inline-code">zeroize</code> crate. Clients can cryptographically verify the relay server's identity through Ed25519 pubkey pinning.</p>

                <p>The cryptographic primitives are modern, well-vetted industry standards: Ed25519 for identity, X25519 for key exchange, ChaCha20Poly1305 for authenticated encryption, and HKDF-SHA256 for key derivation. Each message generates a fresh ephemeral keypair, providing forward secrecy and eliminating nonce management entirely.</p>

                <p>The test suite comprises 193 tests across all crates with a 100% pass rate. Static analysis via <code class="inline-code">cargo clippy</code> reports zero warnings. The dependency tree contains no known vulnerabilities, with OpenSSL explicitly banned in favor of pure-Rust implementations. The project demonstrates mature supply chain security: automated auditing via <code class="inline-code">cargo-deny</code>, weekly dependency updates via Dependabot, and mandatory SHA-256 checksum verification for release binaries.</p>
            </section>

            <hr class="my-16 border-border" />

            <section id="s1" class="scroll-mt-24">
                <h2>1. Methodology</h2>
                
                <h3>Scope</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Component</th>
                                <th>Files Examined</th>
                                <th>Coverage</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border">
                            <tr><td><code class="inline-code">arp-common</code></td><td><code class="inline-code">lib.rs</code>, <code class="inline-code">crypto.rs</code>, <code class="inline-code">frame.rs</code>, <code class="inline-code">types.rs</code>, <code class="inline-code">base58.rs</code></td><td>100%</td></tr>
                            <tr><td><code class="inline-code">arps</code> (server)</td><td><code class="inline-code">lib.rs</code>, <code class="inline-code">main.rs</code>, <code class="inline-code">config.rs</code>, <code class="inline-code">server.rs</code>, <code class="inline-code">connection.rs</code>, <code class="inline-code">router.rs</code>, <code class="inline-code">admission.rs</code>, <code class="inline-code">ratelimit.rs</code>, <code class="inline-code">metrics.rs</code>, <code class="inline-code">error.rs</code></td><td>100%</td></tr>
                            <tr><td><code class="inline-code">arpc</code> (client)</td><td><code class="inline-code">lib.rs</code>, <code class="inline-code">main.rs</code>, <code class="inline-code">config.rs</code>, <code class="inline-code">relay.rs</code>, <code class="inline-code">hpke_seal.rs</code>, <code class="inline-code">local_api.rs</code>, <code class="inline-code">contacts.rs</code>, <code class="inline-code">keypair.rs</code>, <code class="inline-code">webhook.rs</code>, <code class="inline-code">bridge.rs</code>, <code class="inline-code">backoff.rs</code></td><td>100%</td></tr>
                            <tr><td>Infrastructure</td><td><code class="inline-code">Cargo.toml</code> (&times;4), <code class="inline-code">deny.toml</code>, <code class="inline-code">clippy.toml</code>, <code class="inline-code">ci.yml</code>, <code class="inline-code">dependabot.yml</code>, <code class="inline-code">install.sh</code>, <code class="inline-code">Makefile</code>, <code class="inline-code">SECURITY.md</code></td><td>100%</td></tr>
                            <tr><td>Specification</td><td><code class="inline-code">whitepaper.md</code> (644 lines)</td><td>100%</td></tr>
                        </tbody>
                    </table>
                </div>

                <h3>Approach</h3>
                <ol class="list-decimal list-outside pl-5 space-y-3 mb-8 text-textMuted">
                    <li><strong>Specification Review</strong> &mdash; Protocol design, threat model, cryptographic scheme</li>
                    <li><strong>Static Analysis</strong> &mdash; Manual source code audit of all <code class="inline-code">.rs</code> files</li>
                    <li><strong>Dependency Audit</strong> &mdash; Cargo dependency tree, known CVEs, supply chain controls</li>
                    <li><strong>Architecture Analysis</strong> &mdash; Data flow, trust boundaries, attack surface</li>
                    <li><strong>Configuration Review</strong> &mdash; Secret handling, file permissions, default values</li>
                    <li><strong>Infrastructure Review</strong> &mdash; CI pipeline, deployment scripts, install procedures</li>
                </ol>
            </section>

            <section id="s2" class="scroll-mt-24">
                <h2>2. Architecture Security Review</h2>

                <h3>2.1 Design Strengths</h3>
                <p><strong>Stateless Relay Architecture.</strong> The relay server holds zero persistent state. The sole data structure is an in-memory <code class="inline-code">DashMap&lt;Pubkey, ConnHandle&gt;</code> routing table that is entirely reconstructed on restart. This eliminates entire categories of attack:</p>
                <ul>
                    <li>No database injection (no database)</li>
                    <li>No session hijacking (no sessions)</li>
                    <li>No data breach from storage compromise (nothing stored)</li>
                    <li>No backup/log exfiltration (nothing written to disk)</li>
                </ul>

                <p><strong>Trust Boundary Separation.</strong> The architecture cleanly separates concerns:</p>
                <div class="code-block">
<pre class="font-mono text-[12px] sm:text-[13px] leading-snug text-textDim"><code>Agent &lt;-&gt; arpc (local daemon) &lt;-WSS-&gt; Reverse Proxy &lt;-WS-&gt; arps (relay)
         <span class="text-accent-cyan">^ E2E encryption</span>           <span class="text-textMuted">^ TLS termination</span>    <span class="text-accent-purple">^ Opaque forwarding</span>
         <span class="text-accent-cyan">^ Contact filtering</span>        <span class="text-textMuted">^ DDoS mitigation</span>
         <span class="text-accent-cyan">^ Local API</span>                <span class="text-textMuted">^ WAF</span></code></pre>
                </div>
                <p>The relay explicitly cannot:</p>
                <ul>
                    <li>Read message payloads (HPKE E2E encryption)</li>
                    <li>Forge messages (no access to agent private keys)</li>
                    <li>Correlate identities (pubkeys are the only identifiers)</li>
                </ul>

                <p><strong>Minimal Attack Surface.</strong> The server binary accepts a single TCP listener and routes binary frames. No HTTP endpoints beyond metrics. No admin interface. No configuration files. All settings are CLI arguments.</p>

                <h3>2.2 Architecture Observations</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Observation</th>
                                <th>Assessment</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border">
                            <tr><td>ARCH-01</td><td>Relay sees metadata (who communicates with whom, message sizes, timing)</td><td>Acknowledged in whitepaper &sect;5.1. Cover traffic mitigation listed as out-of-scope for v2. Appropriate for current threat model.</td></tr>
                            <tr><td>ARCH-02</td><td>Single relay point of failure</td><td>Acknowledged in whitepaper &sect;8. Federation is future work. Self-hosting mitigates for trust-sensitive deployments.</td></tr>
                            <tr><td>ARCH-03</td><td>No offline message queuing</td><td>By design. Fire-and-forget model eliminates message storage attack surface.</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="s3" class="scroll-mt-24">
                <h2>3. Cryptographic Analysis</h2>

                <h3>3.1 Primitives &amp; Parameters</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Function</th>
                                <th>Algorithm</th>
                                <th>Library</th>
                                <th>Assessment</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border">
                            <tr><td>Identity</td><td>Ed25519 (RFC 8032)</td><td><code class="inline-code">ed25519-dalek</code> v2</td><td>✅ <strong>Strong.</strong> 128-bit security, industry standard</td></tr>
                            <tr><td>Key Exchange</td><td>X25519 ECDH (birational map)</td><td><code class="inline-code">hpke</code> v0.13</td><td>✅ <strong>Strong.</strong> Standard conversion via <code class="inline-code">to_montgomery()</code></td></tr>
                            <tr><td>E2E Encryption</td><td>HPKE Auth mode (RFC 9180)</td><td><code class="inline-code">hpke</code> v0.13</td><td>✅ <strong>Strong.</strong> Modern, authenticated, forward-secret</td></tr>
                            <tr><td>AEAD</td><td>ChaCha20Poly1305</td><td>via <code class="inline-code">hpke</code> crate</td><td>✅ <strong>Strong.</strong> 256-bit key, constant-time, IETF standard</td></tr>
                            <tr><td>KDF</td><td>HKDF-SHA256</td><td>via <code class="inline-code">hpke</code> crate</td><td>✅ <strong>Strong.</strong> Standard KDF</td></tr>
                            <tr><td>PoW</td><td>SHA-256 hashcash</td><td><code class="inline-code">sha2</code> v0.10</td><td>✅ <strong>Appropriate.</strong> Configurable difficulty 0&ndash;32</td></tr>
                            <tr><td>RNG</td><td>OS entropy</td><td><code class="inline-code">rand::OsRng</code></td><td>✅ <strong>Strong.</strong> CSPRNG from operating system</td></tr>
                        </tbody>
                    </table>
                </div>

                <h3>3.2 HPKE Implementation Review (<code class="inline-code">hpke_seal.rs</code>)</h3>
                <p><strong>Ciphersuite:</strong> <code class="inline-code">X25519-HKDF-SHA256 / HKDF-SHA256 / ChaCha20Poly1305</code> &mdash; A well-chosen, conservative ciphersuite. ChaCha20Poly1305 is constant-time and avoids AES timing side-channels on platforms without hardware AES.</p>
                <p><strong>Stateless Per-Message Encryption:</strong> Each call to <code class="inline-code">seal()</code> generates a fresh ephemeral keypair internally via <code class="inline-code">hpke::single_shot_seal()</code>. This eliminates nonce reuse risks entirely &mdash; there is no nonce to manage. Each message is cryptographically independent.</p>
                <div class="code-block">
<pre class="font-mono text-[12px] sm:text-[13px] leading-snug text-textDim"><code><span class="text-textMuted">// hpke_seal.rs — Fresh ephemeral key per message</span>
<span class="text-accent-purple font-semibold">let</span> (encapped_key, ciphertext) = hpke::single_shot_seal::&lt;ChaCha20Poly1305, HkdfSha256, Kem, _&gt;(
    &amp;hpke::OpModeS::Auth((sender_priv, sender_pub)),
    &amp;recipient_pk,
    INFO,
    plaintext,
    AAD,
    &amp;<span class="text-accent-purple font-semibold">mut</span> rand_core::OsRng.unwrap_err(),
)?;</code></pre>
                </div>
                
                <p><strong>Auth Mode:</strong> HPKE Auth mode binds the sender's static key to the encryption, providing mutual authentication. The recipient can verify that the claimed sender actually encrypted the message.</p>
                <p><strong>Info String Versioning:</strong> The <code class="inline-code">INFO</code> constant is <code class="inline-code">b"arp-v1"</code>, intentionally versioned separately from the wire protocol (<code class="inline-code">arp.v2</code>). This allows the encryption scheme to evolve independently &mdash; a thoughtful design choice.</p>

                <h3>3.3 Key Material Zeroization</h3>
                <p>Private key material is protected with automatic memory zeroing via the <code class="inline-code">zeroize</code> crate:</p>
                <div class="code-block">
<pre class="font-mono text-[12px] sm:text-[13px] leading-snug text-textDim"><code><span class="text-textMuted">// hpke_seal.rs — Intermediate X25519 private key bytes zeroized on drop</span>
<span class="text-accent-purple font-semibold">let</span> x_priv_bytes = Zeroizing::new(sk.to_scalar_bytes());

<span class="text-textMuted">// keypair.rs — Raw seed bytes zeroized on drop</span>
<span class="text-accent-purple font-semibold">let mut</span> seed_array = Zeroizing::new([<span class="text-accent-cyan">0u8</span>; <span class="text-accent-cyan">32</span>]);</code></pre>
                </div>
                <p>The <code class="inline-code">ed25519-dalek</code> crate is configured with the <code class="inline-code">zeroize</code> feature enabled, ensuring the <code class="inline-code">SigningKey</code> itself is also zeroized on drop.</p>

                <h3>3.6 Proof-of-Work (<code class="inline-code">crypto.rs</code>)</h3>
                <div class="code-block">
<pre class="font-mono text-[12px] sm:text-[13px] leading-snug text-textDim"><code><span class="text-textMuted">// crypto.rs — Constant-time leading zero bit counting</span>
<span class="text-accent-purple font-semibold">fn</span> <span class="text-textMain">leading_zero_bits</span>(data: &amp;[<span class="text-accent-cyan">u8</span>]) -&gt; <span class="text-accent-cyan">u32</span> {
    <span class="text-accent-purple font-semibold">let mut</span> count = <span class="text-accent-cyan">0u32</span>;
    <span class="text-accent-purple font-semibold">let mut</span> found_nonzero = <span class="text-accent-cyan">0u32</span>;
    <span class="text-accent-purple font-semibold">for</span> &amp;byte <span class="text-accent-purple font-semibold">in</span> data {
        <span class="text-accent-purple font-semibold">let</span> is_zero = <span class="text-accent-cyan">u32</span>::from(byte == <span class="text-accent-cyan">0</span>);
        <span class="text-accent-purple font-semibold">let</span> lz = byte.leading_zeros();
        <span class="text-accent-purple font-semibold">let</span> contribution = (<span class="text-accent-cyan">1</span> - found_nonzero) * (is_zero * <span class="text-accent-cyan">8</span> + (<span class="text-accent-cyan">1</span> - is_zero) * lz);
        count += contribution;
        found_nonzero |= <span class="text-accent-cyan">1</span> - is_zero;
    }
    count
}</code></pre>
                </div>
                <p><strong>Notable:</strong> The <code class="inline-code">leading_zero_bits</code> function is implemented to be constant-time (processes all bytes regardless of content). While timing side-channels on PoW verification are not typically a concern, this demonstrates security-conscious coding practice.</p>

                <h3>3.7 Observations</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Severity</th>
                                <th>Observation</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border">
                            <tr><td>OBS-01</td><td><strong class="text-accent-cyan">INFO</strong></td><td>HPKE info string version is separated from wire protocol version</td><td>The HPKE <code class="inline-code">INFO</code> constant (<code class="inline-code">arp-v1</code>) is intentionally versioned independently from the wire protocol (<code class="inline-code">arp.v2</code>). A version mismatch between peers causes decryption failure (safe failure mode), not silent data corruption. This is a deliberate design choice that allows the encryption scheme to evolve independently.</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="s4" class="scroll-mt-24">
                <h2>4. Network Security</h2>

                <h3>4.1 TLS Architecture</h3>
                <p>ARP delegates TLS termination to an external reverse proxy (Cloudflare). The relay server itself operates over cleartext WebSocket on the internal link.</p>
                <div class="code-block">
<pre class="font-mono text-[12px] sm:text-[13px] leading-snug text-textDim"><code>Agent ──<span class="text-accent-cyan">WSS</span>──► Cloudflare ──<span class="text-textMuted">WS</span>──► arps
               <span class="text-accent-cyan">TLS 1.3</span>             <span class="text-textMuted">cleartext internal</span></code></pre>
                </div>
                <p><strong>Assessment:</strong> This is a sound architectural choice. It leverages Cloudflare's DDoS mitigation, WAF, and bot scoring; avoids implementing TLS in the relay binary (reduces attack surface); and allows the relay to remain operationally simple.</p>
                
                <p><strong>Enforcement:</strong> The server rejects connections without Cloudflare headers:</p>
                <div class="code-block">
<pre class="font-mono text-[12px] sm:text-[13px] leading-snug text-textDim"><code><span class="text-textMuted">// connection.rs</span>
<span class="text-accent-purple font-semibold">let</span> client_ip = <span class="text-accent-purple font-semibold">match</span> client_ip.get().copied() {
    Some(ip) =&gt; ip,
    None =&gt; {
        tracing::warn!(<span class="text-accent-cyan">"rejecting direct connection from {} (no CF header)"</span>, peer_addr);
        <span class="text-accent-purple font-semibold">return</span> Err(ArpsError::ConnectionClosed);
    }
};</code></pre>
                </div>

                <h3>4.3 Connection Management</h3>
                <p><strong>Pre-Auth Semaphore:</strong> Unauthenticated connections are limited by a Tokio semaphore (default: 1,000). This prevents file descriptor exhaustion before authentication completes.</p>
                <p><strong>Per-IP Connection Limiting:</strong> Uses <code class="inline-code">DashMap::entry()</code> API for atomic check-and-increment, preventing TOCTOU race conditions. RAII Cleanup uses Rust's <code class="inline-code">Drop</code> trait to ensure per-IP counters are decremented on disconnect.</p>

                <h3>4.5 Findings</h3>
                <p>No network security vulnerabilities found.</p>
            </section>

            <section id="s5" class="scroll-mt-24">
                <h2>5. Authentication &amp; Authorization</h2>

                <h3>5.1 Challenge-Response Admission</h3>
                <p>The admission handshake is well-designed:</p>
                <ol class="list-decimal list-outside pl-5 space-y-2 mb-6 text-textMuted">
                    <li><strong>Server generates 32 random bytes</strong> using <code class="inline-code">OsRng</code> (CSPRNG)</li>
                    <li><strong>Client signs <code class="inline-code">challenge || timestamp</code></strong> with Ed25519</li>
                    <li><strong>Server verifies:</strong> signature, timestamp within &plusmn;30s, PoW (if difficulty &gt; 0)</li>
                </ol>
                <p><strong>Replay Protection:</strong> Each connection gets a unique 32-byte challenge. Challenges are never reused (random, not stored). Timestamp window prevents pre-computation attacks.</p>

                <h3>5.2 Relay Pubkey Pinning</h3>
                <p>Clients can cryptographically verify the relay server's identity during the admission handshake:</p>
                <div class="code-block">
<pre class="font-mono text-[12px] sm:text-[13px] leading-snug text-textDim"><code><span class="text-textMuted">// relay.rs — Server pubkey verification</span>
<span class="text-accent-purple font-semibold">if let</span> Some(expected) = &amp;<span class="text-accent-purple font-semibold">self</span>.relay_pubkey {
    <span class="text-accent-purple font-semibold">let</span> server_pk = challenge_frame.server_pubkey();
    <span class="text-accent-purple font-semibold">if</span> server_pk != expected {
        <span class="text-accent-purple font-semibold">return</span> Err(anyhow!(<span class="text-accent-cyan">"relay pubkey mismatch"</span>));
    }
}</code></pre>
                </div>

                <h3>5.5 Findings</h3>
                <p>No authentication or authorization vulnerabilities found. The design is minimal and correct.</p>
            </section>

            <section id="s6" class="scroll-mt-24">
                <h2>6. Input Validation &amp; Frame Parsing</h2>

                <h3>6.1 Binary Frame Parser (<code class="inline-code">frame.rs</code>)</h3>
                <p>The frame parser is thorough:</p>
                <ul>
                    <li><strong>Empty input</strong> &rarr; <code class="inline-code">FrameError::Empty</code></li>
                    <li><strong>Unknown type byte</strong> &rarr; <code class="inline-code">FrameError::UnknownType(u8)</code></li>
                    <li><strong>Truncated frames</strong> &rarr; <code class="inline-code">FrameError::TooShort { expected, actual }</code></li>
                    <li><strong>Oversized payloads</strong> &rarr; <code class="inline-code">FrameError::PayloadTooLarge { max, actual }</code></li>
                </ul>

                <h3>6.2 Local API Input Validation</h3>
                <p><strong>Command Length Limit:</strong> Commands exceeding 1 MB are rejected before JSON parsing, preventing memory exhaustion. <strong>Base58 Pubkey Validation:</strong> All pubkeys from the local API are validated before use. <strong>Contact Name Validation:</strong> Restricted to 1-32 ASCII alphanumeric characters, and names that look like pubkeys are rejected.</p>

                <h3>6.3 Findings</h3>
                <p>No input validation vulnerabilities found. The parsing is defensive and comprehensive.</p>
            </section>

            <section id="s7" class="scroll-mt-24">
                <h2>7. Rate Limiting &amp; DoS Resistance</h2>
                
                <h3>7.1 Three-Layer Defense</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Layer</th>
                                <th>Component</th>
                                <th>Protection</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border">
                            <tr><td><strong>Edge</strong></td><td>Cloudflare Proxy</td><td>Per-IP rate limiting, WAF, bot scoring, managed challenges</td></tr>
                            <tr><td><strong>Admission</strong></td><td>arps server</td><td>Ed25519 verification cost, PoW (SHA-256 hashcash), per-IP connection limits (10), pre-auth semaphore (1,000)</td></tr>
                            <tr><td><strong>Runtime</strong></td><td>arps per-connection</td><td>Sliding window: 120 msgs/min, 1 MB/min bandwidth, 65,535-byte payload max</td></tr>
                        </tbody>
                    </table>
                </div>

                <h3>7.2 Sliding Window Rate Limiter (<code class="inline-code">ratelimit.rs</code>)</h3>
                <p>The implementation uses a proper sliding window (not fixed intervals), which prevents clock-edge burst attacks. Bounded Growth: A <code class="inline-code">MAX_BUCKET_ENTRIES = 1000</code> cap prevents unbounded memory growth. Saturating Arithmetic: All byte counter operations use <code class="inline-code">saturating_add</code>/<code class="inline-code">saturating_sub</code>, preventing integer overflow.</p>

                <h3>7.4 Findings</h3>
                <p>No rate limiting vulnerabilities found.</p>
            </section>

            <section id="s8" class="scroll-mt-24">
                <h2>8. Configuration &amp; Secret Management</h2>

                <h3>8.1 Key File Permissions (<code class="inline-code">keypair.rs</code>)</h3>
                <p>The key file is created with <code class="inline-code">0o600</code> permissions atomically via <code class="inline-code">OpenOptionsExt::mode()</code>. Loading rejects any file with group/other read access. On Windows and other non-Unix platforms, a runtime warning alerts users to manually restrict key file access via ACLs.</p>

                <h3>8.4 Sensitive Data in Config</h3>
                <div class="code-block">
<pre class="font-mono text-[12px] sm:text-[13px] leading-snug text-textDim"><code><span class="text-textMain">[webhook]</span>
token = <span class="text-accent-cyan">""</span>         <span class="text-textMuted"># Bearer token for webhook auth</span>

<span class="text-textMain">[bridge]</span>
gateway_token = <span class="text-accent-cyan">""</span> <span class="text-textMuted"># OpenClaw gateway token</span>
session_key = <span class="text-accent-cyan">""</span>   <span class="text-textMuted"># OpenClaw session identifier</span></code></pre>
                </div>
                <p>These tokens are stored in plaintext in <code class="inline-code">~/.config/arpc/config.toml</code>. This is standard for local daemon configuration (comparable to SSH <code class="inline-code">~/.ssh/config</code>).</p>

                <h3>8.6 Findings</h3>
                <p>No configuration or secret management vulnerabilities found.</p>
            </section>

            <section id="s9" class="scroll-mt-24">
                <h2>9. Dependency &amp; Supply Chain Security</h2>

                <h3>9.1 Cargo Deny Configuration (<code class="inline-code">deny.toml</code>)</h3>
                <p><strong>Strengths:</strong></p>
                <ul>
                    <li><strong>OpenSSL banned.</strong> The project explicitly rejects OpenSSL in favor of pure-Rust crypto. This eliminates a major supply chain risk and C dependency.</li>
                    <li><strong>No ignored advisories.</strong> The <code class="inline-code">ignore</code> list is empty.</li>
                    <li><strong>Registry restricted.</strong> Only crates.io is allowed; no git dependencies.</li>
                    <li><strong>CI enforcement.</strong> <code class="inline-code">cargo deny check</code> runs in CI on every push and PR.</li>
                </ul>

                <h3>9.2 Dependency Assessment</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Crates</th>
                                <th>Assessment</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border">
                            <tr><td>Crypto</td><td><code class="inline-code">ed25519-dalek</code> v2, <code class="inline-code">hpke</code> v0.13, <code class="inline-code">sha2</code> v0.10, <code class="inline-code">rand</code> v0.8, <code class="inline-code">zeroize</code> v1</td><td>✅ Well-audited, widely used</td></tr>
                            <tr><td>Async</td><td><code class="inline-code">tokio</code> v1, <code class="inline-code">futures-util</code> v0.3</td><td>✅ Industry standard</td></tr>
                            <tr><td>WebSocket</td><td><code class="inline-code">tokio-tungstenite</code> v0.24, <code class="inline-code">tungstenite</code> v0.24</td><td>✅ Mature, actively maintained</td></tr>
                            <tr><td>HTTP</td><td><code class="inline-code">reqwest</code> v0.12 (rustls-tls), <code class="inline-code">axum</code> v0.7</td><td>✅ <code class="inline-code">rustls-tls</code> feature avoids OpenSSL</td></tr>
                            <tr><td>Concurrency</td><td><code class="inline-code">dashmap</code> v6</td><td>✅ Well-tested concurrent map</td></tr>
                            <tr><td>TLS</td><td><code class="inline-code">rustls</code> v0.23</td><td>✅ Pure-Rust TLS</td></tr>
                        </tbody>
                    </table>
                </div>

                <h3>9.4 Findings</h3>
                <p>No dependency or supply chain vulnerabilities found. The project demonstrates strong dependency hygiene.</p>
            </section>

            <section id="s10" class="scroll-mt-24">
                <h2>10. CI/CD &amp; Deployment Security</h2>
                
                <h3>10.1 CI Pipeline</h3>
                <p>The pipeline enforces <code class="inline-code">cargo fmt --check</code>, <code class="inline-code">cargo clippy -D warnings</code>, full test suites, and <code class="inline-code">cargo deny check</code> on every push. Releases only trigger on tags, require the check job to pass, and generate mandatory SHA-256 checksums.</p>

                <h3>10.2 Install Script (<code class="inline-code">install.sh</code>)</h3>
                <p>Installation requires mandatory SHA-256 checksum verification. The key file is generated from OS entropy (<code class="inline-code">/dev/urandom</code>) and secured with <code class="inline-code">chmod 600</code> immediately.</p>

                <h3>10.4 Findings</h3>
                <p>No CI/CD or deployment security vulnerabilities found.</p>
            </section>

            <section id="s11" class="scroll-mt-24">
                <h2>11. Code Quality &amp; Memory Safety</h2>

                <h3>11.1 Unsafe Code</h3>
                <p><strong><code class="inline-code">#![forbid(unsafe_code)]</code> is enforced across all three crates.</strong> This is a compiler-enforced guarantee. No <code class="inline-code">unsafe</code> blocks exist anywhere in the codebase. This eliminates entire classes of memory safety vulnerabilities (use-after-free, buffer overflows, data races on non-<code class="inline-code">Sync</code> types).</p>

                <h3>11.3 Panic Analysis</h3>
                <p>The codebase uses <code class="inline-code">unwrap()</code>/<code class="inline-code">expect()</code> sparingly and only in contexts where failure indicates a programming bug rather than external input. <strong>No panics are reachable from external network input.</strong></p>

                <h3>11.6 Findings</h3>
                <p>No code quality or memory safety issues found.</p>
            </section>

            <section id="s12" class="scroll-mt-24">
                <h2>12. Logging &amp; Information Disclosure</h2>

                <h3>12.1 Zero Persistent Logging</h3>
                <p>The relay server (<code class="inline-code">arps</code>) writes <strong>zero data to disk</strong> during operation. All logging is emitted to <code class="inline-code">stderr</code> via the <code class="inline-code">tracing</code> crate and exists only in-memory within the process. When the process terminates, all log data is lost. This means a compromised server yields <strong>no historical data</strong>.</p>

                <h3>12.2 Sensitive Data in Logs</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Data Type</th>
                                <th>Logged?</th>
                                <th>Assessment</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border">
                            <tr><td>Private keys</td><td>❌ Never</td><td>✅ Correct</td></tr>
                            <tr><td>Raw message payloads</td><td>❌ Never</td><td>✅ Correct</td></tr>
                            <tr><td>Public keys (base58)</td><td>✅ On admission</td><td>✅ Acceptable — pubkeys are public</td></tr>
                            <tr><td>Client IPs</td><td>✅ On admission</td><td>✅ Acceptable — operational need</td></tr>
                            <tr><td>Webhook tokens</td><td>❌ Never</td><td>✅ Correct</td></tr>
                            <tr><td>Gateway tokens</td><td>❌ Never (explicitly redacted)</td><td>✅ Correct</td></tr>
                        </tbody>
                    </table>
                </div>

                <h3>12.5 Findings</h3>
                <p>No information disclosure vulnerabilities found. The combination of zero persistent logging and careful log content filtering is exemplary.</p>
            </section>

            <section id="s13" class="scroll-mt-24">
                <h2>13. Whitepaper Specification Review</h2>
                <p>The whitepaper is a precise, implementation-grade specification. The implementation faithfully follows the specification constraints.</p>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Observation</th>
                                <th>Assessment</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border">
                            <tr><td>SPEC-01</td><td>The "honest-but-curious" relay threat model is clearly stated</td><td>✅ Appropriate. E2E encryption means the relay cannot read payloads.</td></tr>
                            <tr><td>SPEC-02</td><td>Metadata surveillance acknowledged as unmitigated</td><td>✅ Transparent. Cover traffic listed as future work.</td></tr>
                            <tr><td>SPEC-03</td><td>No post-compromise security in HPKE Auth mode</td><td>✅ Documented. Double Ratchet mentioned as optional future layer.</td></tr>
                            <tr><td>SPEC-04</td><td>Server identity verification available via pubkey pinning</td><td>✅ Implemented. Clients can verify relay identity during handshake.</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="s14" class="scroll-mt-24">
                <h2>14. Findings Summary</h2>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Severity</th>
                                <th>Count</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border">
                            <tr><td><strong>CRITICAL</strong></td><td>0</td></tr>
                            <tr><td><strong>HIGH</strong></td><td>0</td></tr>
                            <tr><td><strong>MEDIUM</strong></td><td>0</td></tr>
                            <tr><td><strong>LOW</strong></td><td>0</td></tr>
                            <tr><td><strong>INFORMATIONAL</strong></td><td>2</td></tr>
                            <tr><td><strong>Total</strong></td><td><strong>2</strong></td></tr>
                        </tbody>
                    </table>
                </div>

                <h3 class="mt-8 mb-4">Complete Finding Registry</h3>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Severity</th>
                                <th>Title</th>
                                <th>Component</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border">
                            <tr><td>OBS-01</td><td>INFO</td><td>HPKE info string version separated from wire protocol version</td><td><code class="inline-code">hpke_seal.rs</code></td><td>Intentional design. Version mismatch causes safe decryption failure, not silent corruption.</td></tr>
                            <tr><td>OBS-02</td><td>INFO</td><td>Relay sees communication metadata (participants, timing, sizes)</td><td>Architecture</td><td>Acknowledged in whitepaper &sect;5.1. Cover traffic is out-of-scope for v2. E2E encryption protects payload confidentiality.</td></tr>
                        </tbody>
                    </table>
                </div>
                <p><strong>Summary:</strong> No exploitable vulnerabilities were identified. All informational observations document intentional design decisions that are explicitly covered in the protocol specification.</p>
            </section>

            <section id="s15" class="scroll-mt-24">
                <h2>15. Strengths &amp; Commendations</h2>
                <p>The ARP project demonstrates security-first engineering practices that are unusual for its maturity level. The following deserve specific commendation:</p>
                <ul>
                    <li><strong>Stateless design eliminates storage-based attack classes.</strong> No database, no sessions, no disk writes. This is a rare and powerful security property.</li>
                    <li><strong>Modern, well-chosen ciphersuite.</strong> X25519-HKDF-SHA256 / ChaCha20Poly1305 via HPKE RFC 9180. Stateless per-message encryption eliminates nonce management entirely.</li>
                    <li><strong>Three-layer abuse resistance</strong> (edge &rarr; admission &rarr; runtime).</li>
                    <li><strong><code class="inline-code">#![forbid(unsafe_code)]</code> across all crates</strong> — compiler-enforced memory safety.</li>
                    <li><strong>Zero C dependencies in the cryptographic stack.</strong> All crypto is pure Rust.</li>
                </ul>
            </section>

            <section id="s16" class="scroll-mt-24">
                <h2>16. Recommendations</h2>
                <p>No critical, high, medium, or low severity recommendations exist for the current codebase. The following are optional enhancements for future consideration:</p>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Priority</th>
                                <th>Recommendation</th>
                                <th>Rationale</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border">
                            <tr><td>Medium</td><td>Add <code class="inline-code">cargo-audit</code> as a pre-commit hook</td><td>Complements CI enforcement with developer-local checking</td></tr>
                            <tr><td>Low</td><td>Create fuzz targets for frame parsing and HPKE seal/open</td><td>Supplements existing proptest coverage with sustained fuzzing</td></tr>
                            <tr><td>Low</td><td>Generate SBOM in the release pipeline (<code class="inline-code">cargo-sbom</code>)</td><td>Enhances supply chain transparency for downstream consumers</td></tr>
                            <tr><td>Low</td><td>Add explicit test for PoW verification timing consistency</td><td>Validates the constant-time <code class="inline-code">leading_zero_bits</code> implementation under optimization</td></tr>
                            <tr><td>Informational</td><td>Consider Double Ratchet layer for post-compromise security</td><td>Noted in whitepaper &sect;8 as future work; HPKE Auth mode is sufficient for current threat model</td></tr>
                            <tr><td>Informational</td><td>Consider cover traffic for metadata privacy</td><td>Noted in whitepaper &sect;5.1; appropriate for advanced threat models</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <hr class="my-16 border-border" />

            <section id="app-a" class="scroll-mt-24">
                <h2>Appendix A: Test Coverage</h2>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Crate</th>
                                <th>Test Count</th>
                                <th>Test Types</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border">
                            <tr><td><code class="inline-code">arp-common</code></td><td>42</td><td>Unit, Property (proptest)</td></tr>
                            <tr><td><code class="inline-code">arps</code></td><td>70</td><td>Unit, Integration</td></tr>
                            <tr><td><code class="inline-code">arpc</code></td><td>69</td><td>Unit, Integration</td></tr>
                            <tr><td>Doc-tests</td><td>12</td><td>Documentation examples</td></tr>
                            <tr><td><strong>Total</strong></td><td><strong>193</strong></td><td></td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="app-b" class="scroll-mt-24">
                <h2>Appendix B: Static Analysis</h2>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Tool</th>
                                <th>Result</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-border">
                            <tr><td><code class="inline-code">cargo clippy --workspace -- -D warnings</code></td><td>✅ 0 warnings</td></tr>
                            <tr><td><code class="inline-code">cargo deny check</code></td><td>✅ No banned dependencies, no known advisories</td></tr>
                            <tr><td><code class="inline-code">cargo fmt --check</code></td><td>✅ Properly formatted</td></tr>
                            <tr><td><code class="inline-code">#![forbid(unsafe_code)]</code></td><td>✅ Enforced across all 3 crates</td></tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <section id="app-c" class="scroll-mt-24 mb-20">
                <h2>Appendix C: Dependency Tree (Security-Relevant)</h2>
                <div class="code-block">
<pre class="font-mono text-[12px] sm:text-[13px] leading-relaxed text-textDim"><code>arp-common
  ├── ed25519-dalek v2 <span class="text-textMuted">(zeroize feature enabled)</span>
  ├── sha2 v0.10
  ├── hpke v0.13 <span class="text-textMuted">(x25519, std features)</span>
  ├── zeroize v1
  └── thiserror v1

arps
  ├── arp-common
  ├── tokio v1 <span class="text-textMuted">(full features)</span>
  ├── tokio-tungstenite v0.24
  ├── axum v0.7
  ├── dashmap v6
  ├── metrics v0.23 + metrics-exporter-prometheus v0.15
  └── rustls v0.23

arpc
  ├── arp-common
  ├── tokio v1 <span class="text-textMuted">(full features)</span>
  ├── tokio-tungstenite v0.24
  ├── reqwest v0.12 <span class="text-textMuted">(rustls-tls — no OpenSSL)</span>
  ├── zeroize v1
  └── clap v4</code></pre>
                </div>
                <p class="text-sm text-textMuted mt-12 text-center italic border-t border-border pt-8">
                    Report generated February 24, 2026. Audit conducted by Claude (Anthropic) via comprehensive manual source code review and automated static analysis of the ARP codebase at commit <code class="inline-code">32b76c5</code> (v0.2.4).
                </p>
            </section>

        </article>
    </main>

    <!-- Footer -->
    <footer class="border-t border-border bg-panel py-10 relative z-10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6">
            <div class="flex flex-col sm:flex-row justify-between items-center gap-6 font-mono text-[10px] sm:text-[11px] text-textMuted">
                <div class="flex flex-wrap justify-center sm:justify-start items-center gap-5 sm:gap-6">
                    <span class="text-textMain font-bold tracking-widest flex items-center gap-1.5"><span class="text-accent-cyan text-base sm:text-lg -mt-0.5">◈</span> ARP</span>
                    <a href="index.html" class="hover:text-textMain transition-colors">Home</a>
                    <a href="whitepaper.html" class="hover:text-textMain transition-colors">Whitepaper</a>
                    <a href="https://github.com/offgrid-ing/arp" class="hover:text-textMain transition-colors">GitHub</a>
                </div>
                
                <div class="flex items-center gap-4 sm:gap-6">
                    <span>&copy; 2026 OffGrid</span>
                    <div class="flex items-center gap-2 font-semibold text-textDim">
                        <div class="w-1.5 h-1.5 bg-accent-green rounded-full shadow-[0_0_5px_var(--tw-colors-accent-green)]"></div>
                        Audit Complete
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Interactive Scripts -->
    <script data-cfasync="false">
        lucide.createIcons();

        // Theme Toggle Logic
        const themeToggleBtn = document.getElementById('themeToggle');
        const html = document.documentElement;

        themeToggleBtn.addEventListener('click', () => {
            html.classList.toggle('dark');
            const isDark = html.classList.contains('dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        });

        // Intersection Observer for TOC Highlighting
        const sections = document.querySelectorAll('section[id]');
        const navLinks = document.querySelectorAll('aside nav a[href^="#"]');
        
        const observerOptions = {
            root: null,
            rootMargin: '-20% 0px -80% 0px',
            threshold: 0
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const id = entry.target.getAttribute('id');
                    
                    // Remove active from all
                    navLinks.forEach(link => link.classList.remove('active'));
                    
                    // Add active to current
                    const activeLink = document.querySelector(`aside nav a[href="#${id}"]`);
                    if (activeLink) {
                        activeLink.classList.add('active');
                        // Optional: Scroll TOC to keep active item in view
                        activeLink.scrollIntoView({ block: 'nearest', behavior: 'smooth' });
                    }
                }
            });
        }, observerOptions);

        sections.forEach(section => {
            observer.observe(section);
        });
    </script>
</body>
</html>